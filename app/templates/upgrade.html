<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upgrade Your Plan â€” Forge</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='8' fill='%236366f1'/><text x='16' y='23' text-anchor='middle' fill='white' font-size='20' font-weight='bold' font-family='Inter,sans-serif'>F</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
    :root{--bg:#09090b;--bg1:#111114;--bg2:#1a1a1f;--bg3:#232329;--surface:#18181b;--border:#27272a;--border-light:#3f3f46;--text:#fafafa;--text2:#a1a1aa;--text3:#71717a;--primary:#6366f1;--primary-light:#818cf8;--primary-dark:#4f46e5;--accent:#06b6d4;--danger:#ef4444;--success:#10b981;--warning:#f59e0b;--radius:12px;--radius-sm:8px}
    body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding:24px}
    .bg-glow{position:fixed;border-radius:50%;filter:blur(120px);pointer-events:none;z-index:0}
    .bg-glow-1{width:500px;height:500px;background:rgba(99,102,241,.1);top:-150px;left:-100px}
    .bg-glow-2{width:400px;height:400px;background:rgba(6,182,212,.08);bottom:-100px;right:-100px}

    .upgrade-container{position:relative;z-index:1;max-width:1100px;margin:0 auto}
    .top-nav{display:flex;align-items:center;justify-content:space-between;margin-bottom:40px}
    .logo-row{display:flex;align-items:center;gap:10px}
    .logo-text{font-weight:800;font-size:22px}
    .back-link{display:inline-flex;align-items:center;gap:6px;color:var(--text3);font-size:14px;font-weight:600;text-decoration:none;transition:.2s}
    .back-link:hover{color:var(--text2)}

    .hero-text{text-align:center;margin-bottom:40px}
    .hero-text h1{font-size:32px;font-weight:900;margin-bottom:8px;background:linear-gradient(135deg,var(--primary-light),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .hero-text p{color:var(--text2);font-size:16px;max-width:560px;margin:0 auto}

    /* Billing Toggle */
    .billing-toggle{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:40px}
    .billing-label{font-size:14px;font-weight:600;color:var(--text3);cursor:pointer;transition:.2s}
    .billing-label.active{color:var(--text)}
    .toggle-switch{position:relative;width:52px;height:28px;background:var(--bg3);border-radius:14px;cursor:pointer;transition:.3s;border:1px solid var(--border)}
    .toggle-switch.active{background:var(--primary)}
    .toggle-switch::after{content:'';position:absolute;top:3px;left:3px;width:20px;height:20px;background:#fff;border-radius:50%;transition:.3s}
    .toggle-switch.active::after{left:27px}
    .savings-badge{display:inline-block;padding:3px 10px;border-radius:50px;font-size:11px;font-weight:700;background:rgba(16,185,129,.15);color:var(--success)}

    /* Plans Grid */
    .plans-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin-bottom:60px}
    .plan-card{background:var(--surface);border:1.5px solid var(--border);border-radius:var(--radius);padding:32px 24px;transition:.2s;position:relative}
    .plan-card:hover{transform:translateY(-4px);border-color:var(--border-light);box-shadow:0 8px 30px rgba(0,0,0,.2)}
    .plan-card.featured{border-color:var(--primary);box-shadow:0 0 40px rgba(99,102,241,.15),0 0 80px rgba(99,102,241,.05)}
    .plan-card.featured::before{content:'';position:absolute;top:-1px;left:-1px;right:-1px;height:3px;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:var(--radius) var(--radius) 0 0}
    .plan-badge{display:inline-block;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;padding:4px 10px;border-radius:50px;margin-bottom:16px}
    .plan-card:not(.featured) .plan-badge{background:var(--bg3);color:var(--text2)}
    .plan-card.featured .plan-badge{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff}
    .plan-name{font-size:20px;font-weight:800;margin-bottom:4px}
    .plan-price{font-size:36px;font-weight:900;margin-bottom:2px;letter-spacing:-.02em}
    .plan-price span{font-size:15px;font-weight:500;color:var(--text3)}
    .plan-price-annual{font-size:12px;color:var(--text3);margin-bottom:4px;min-height:18px}
    .plan-desc{font-size:13px;color:var(--text3);margin-bottom:20px;min-height:36px}
    .plan-features{list-style:none;display:flex;flex-direction:column;gap:10px;margin-bottom:24px}
    .plan-features li{display:flex;align-items:flex-start;gap:8px;font-size:13px;color:var(--text2);line-height:1.4}
    .plan-features li svg{flex-shrink:0;color:var(--success);margin-top:1px}
    .plan-btn{width:100%;padding:13px;border:none;border-radius:var(--radius-sm);font-size:15px;font-weight:700;cursor:pointer;transition:.2s}
    .plan-btn-primary{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff}
    .plan-btn-primary:hover{box-shadow:0 4px 20px rgba(99,102,241,.4);transform:translateY(-1px)}
    .plan-btn-outline{background:transparent;border:1.5px solid var(--border);color:var(--text2)}
    .plan-btn-outline:hover{border-color:var(--primary);color:var(--primary-light)}

    /* FAQ */
    .faq-section{max-width:700px;margin:0 auto 60px}
    .faq-title{text-align:center;font-size:22px;font-weight:800;margin-bottom:24px}
    .faq-item{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);margin-bottom:8px;overflow:hidden}
    .faq-q{padding:16px 20px;font-size:14px;font-weight:600;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:.2s}
    .faq-q:hover{color:var(--primary-light)}
    .faq-q .faq-arrow{transition:transform .3s;font-size:12px;color:var(--text3)}
    .faq-q.open .faq-arrow{transform:rotate(180deg)}
    .faq-a{max-height:0;overflow:hidden;transition:max-height .3s ease,padding .3s ease;padding:0 20px;font-size:13px;color:var(--text2);line-height:1.7}
    .faq-a.open{max-height:200px;padding:0 20px 16px}

    /* Modal */
    .modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);z-index:200;align-items:center;justify-content:center}
    .modal-overlay.show{display:flex;animation:fadeIn .3s ease}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .modal{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);width:90%;max-width:440px;padding:32px;text-align:center;animation:slideUp .3s ease}
    @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    .modal h2{font-size:20px;font-weight:800;margin-bottom:8px}
    .modal .modal-sub{font-size:14px;color:var(--text2);margin-bottom:24px}
    .modal-plan-tag{display:inline-block;padding:4px 12px;border-radius:50px;font-size:12px;font-weight:700;background:rgba(99,102,241,.15);color:var(--primary-light);margin-bottom:16px}
    .modal input{width:100%;padding:12px 16px;border:1.5px solid var(--border);border-radius:var(--radius-sm);background:var(--bg2);color:var(--text);font-size:14px;margin-bottom:12px;outline:none;transition:.2s}
    .modal input:focus{border-color:var(--primary)}
    .modal input::placeholder{color:var(--text3)}
    .modal-submit{width:100%;padding:13px;border:none;border-radius:var(--radius-sm);background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;font-size:15px;font-weight:700;cursor:pointer;transition:.2s;margin-bottom:12px}
    .modal-submit:hover{box-shadow:0 4px 20px rgba(99,102,241,.4)}
    .modal-submit:disabled{opacity:.5;cursor:not-allowed}
    .modal-cancel{background:none;border:none;color:var(--text3);font-size:13px;cursor:pointer;transition:.2s}
    .modal-cancel:hover{color:var(--text2)}
    .modal-success{display:none;text-align:center;padding:20px 0}
    .modal-success.show{display:block}
    .modal-success .check-icon{width:56px;height:56px;margin:0 auto 16px;background:rgba(16,185,129,.15);border-radius:50%;display:flex;align-items:center;justify-content:center}
    .modal-form.hidden{display:none}

    /* Current Plan Badge */
    .current-plan-badge{display:inline-block;padding:4px 12px;border-radius:50px;font-size:11px;font-weight:700;background:rgba(16,185,129,.15);color:var(--success);border:1px solid rgba(16,185,129,.25);margin-left:8px;vertical-align:middle}

    /* Feature Comparison Table */
    .comparison-section{max-width:900px;margin:0 auto 60px}
    .comparison-title{text-align:center;font-size:22px;font-weight:800;margin-bottom:24px}
    .comparison-table{width:100%;border-collapse:collapse;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
    .comparison-table th{text-align:left;font-size:13px;font-weight:700;padding:14px 16px;background:var(--bg2);border-bottom:1px solid var(--border);color:var(--text)}
    .comparison-table th:not(:first-child){text-align:center}
    .comparison-table td{padding:12px 16px;border-bottom:1px solid var(--border);font-size:13px;color:var(--text2)}
    .comparison-table td:not(:first-child){text-align:center}
    .comparison-table tr:last-child td{border-bottom:none}
    .comparison-table tr:hover td{background:var(--bg2)}
    .check-mark{color:var(--success);font-weight:700}
    .dash-mark{color:var(--text3)}

    @media(max-width:768px){
      .plans-grid{grid-template-columns:1fr}
      .hero-text h1{font-size:24px}
      .comparison-table{font-size:12px}
      .comparison-table th,.comparison-table td{padding:10px 8px}
    }
  </style>
</head>
<body>
  <div class="bg-glow bg-glow-1"></div>
  <div class="bg-glow bg-glow-2"></div>

  <div class="upgrade-container">
    <div class="top-nav">
      <div class="logo-row">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
          <rect width="32" height="32" rx="8" fill="url(#lg)"/>
          <path d="M10 24h12M13 24v-4h6v4M11 20h10M9 14l3-2h8l3 2v3a1 1 0 01-1 1H10a1 1 0 01-1-1v-3z" stroke="#fff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M14 12V9a2 2 0 014 0v3" stroke="#fff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          <defs><linearGradient id="lg" x1="0" y1="0" x2="32" y2="32"><stop stop-color="#6366f1"/><stop offset="1" stop-color="#06b6d4"/></linearGradient></defs>
        </svg>
        <span class="logo-text">Forge</span>
      </div>
      {% if trial_active %}
      <a href="/dashboard" class="back-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
        Back to Dashboard
      </a>
      {% else %}
      <a href="/login" class="back-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
        Back to Login
      </a>
      {% endif %}
    </div>

    <div class="hero-text">
      {% if trial_active %}
      <h1>Upgrade Your Plan</h1>
      <p>Choose the plan that fits your business. All plans include a 14-day free trial.</p>
      {% else %}
      <h1>Your Free Trial Has Ended</h1>
      <p>Upgrade to keep using Forge's powerful analytics and grow your business.</p>
      {% endif %}
    </div>

    <!-- Billing Toggle -->
    <div class="billing-toggle">
      <span class="billing-label active" id="lblMonthly">Monthly</span>
      <div class="toggle-switch" id="billingToggle"></div>
      <span class="billing-label" id="lblAnnual">Annual</span>
      <span class="savings-badge">Save 20%</span>
    </div>

    <!-- Plans -->
    <div class="plans-grid">
      <!-- Starter -->
      <div class="plan-card" data-plan="starter">
        <span class="plan-badge">Starter</span>{% if user and user.plan_tier == 'starter' %}<span class="current-plan-badge">Current Plan</span>{% endif %}
        <div class="plan-name">Starter</div>
        <div class="plan-price"><span class="price-val">$49</span><span>/month</span></div>
        <div class="plan-price-annual annual-price" style="display:none">Billed as $470/year</div>
        <div class="plan-desc">Perfect for single-location shops getting started with data</div>
        <ul class="plan-features">
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Sales & revenue analytics</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Customer insights & segments</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Product performance tracking</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Basic alerts & notifications</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> CSV data export</li>
        </ul>
        <button class="plan-btn plan-btn-outline" onclick="openModal('starter')">Choose Starter</button>
      </div>

      <!-- Growth (Most Popular) -->
      <div class="plan-card featured" data-plan="growth">
        <span class="plan-badge">Most Popular</span>{% if user and user.plan_tier == 'growth' %}<span class="current-plan-badge">Current Plan</span>{% endif %}
        <div class="plan-name">Growth</div>
        <div class="plan-price"><span class="price-val">$99</span><span>/month</span></div>
        <div class="plan-price-annual annual-price" style="display:none">Billed as $950/year</div>
        <div class="plan-desc">Everything you need to outpace your competitors</div>
        <ul class="plan-features">
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Everything in Starter</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> AI-powered recommendations</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Full competitor intelligence</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Marketing content engine</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Win-back campaigns</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Goals & strategy planner</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Priority email support</li>
        </ul>
        <button class="plan-btn plan-btn-primary" onclick="openModal('growth')">Choose Growth</button>
      </div>

      <!-- Scale -->
      <div class="plan-card" data-plan="scale">
        <span class="plan-badge">Scale</span>{% if user and user.plan_tier == 'scale' %}<span class="current-plan-badge">Current Plan</span>{% endif %}
        <div class="plan-name">Scale</div>
        <div class="plan-price"><span class="price-val">$199</span><span>/month</span></div>
        <div class="plan-price-annual annual-price" style="display:none">Billed as $1,910/year</div>
        <div class="plan-desc">For growing businesses with multiple locations</div>
        <ul class="plan-features">
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Everything in Growth</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Multi-location support</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Advanced financial reports</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Custom integrations (API)</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Team member accounts</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Dedicated account manager</li>
          <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> Phone & chat support</li>
        </ul>
        <button class="plan-btn plan-btn-outline" onclick="openModal('scale')">Choose Scale</button>
      </div>
    </div>

    <!-- Feature Comparison -->
    <div class="comparison-section">
      <h2 class="comparison-title">Feature Comparison</h2>
      <table class="comparison-table">
        <thead>
          <tr>
            <th>Feature</th>
            <th>Starter</th>
            <th>Growth</th>
            <th>Scale</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Sales & Revenue Analytics</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Customer Segmentation</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Product Performance</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Basic Alerts</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>CSV Export</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>AI Recommendations</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Competitor Intelligence</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Marketing Content Engine</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Win-Back Campaigns</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Goals & Strategy Planner</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Daily Briefing</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Multi-Location Support</td><td class="dash-mark">&mdash;</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Advanced Financial Reports</td><td class="dash-mark">&mdash;</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Custom API Integrations</td><td class="dash-mark">&mdash;</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Team Member Accounts</td><td class="dash-mark">&mdash;</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Dedicated Account Manager</td><td class="dash-mark">&mdash;</td><td class="dash-mark">&mdash;</td><td class="check-mark">&#10003;</td></tr>
          <tr><td>Support</td><td>Email</td><td>Priority Email</td><td>Phone & Chat</td></tr>
        </tbody>
      </table>
    </div>

    <!-- FAQ -->
    <div class="faq-section">
      <h2 class="faq-title">Frequently Asked Questions</h2>
      <div class="faq-item">
        <div class="faq-q" onclick="toggleFaq(this)">Can I switch plans later? <span class="faq-arrow">&#9660;</span></div>
        <div class="faq-a">Absolutely! You can upgrade or downgrade your plan at any time. Changes take effect at the start of your next billing cycle. No penalties or hidden fees.</div>
      </div>
      <div class="faq-item">
        <div class="faq-q" onclick="toggleFaq(this)">What POS systems do you support? <span class="faq-arrow">&#9660;</span></div>
        <div class="faq-a">Forge integrates with Shopify, Square, Clover, Lightspeed, and Toast. More integrations are added regularly. Can't find yours? Contact us and we'll work on it.</div>
      </div>
      <div class="faq-item">
        <div class="faq-q" onclick="toggleFaq(this)">Is my data secure? <span class="faq-arrow">&#9660;</span></div>
        <div class="faq-a">Yes. We use bank-level encryption (AES-256) for all data at rest and TLS 1.3 for data in transit. Your data is never sold or shared with third parties.</div>
      </div>
      <div class="faq-item">
        <div class="faq-q" onclick="toggleFaq(this)">What happens when my trial ends? <span class="faq-arrow">&#9660;</span></div>
        <div class="faq-a">Your data is safely preserved for 30 days after your trial ends. Simply choose a plan to pick up right where you left off. No data is lost.</div>
      </div>
      <div class="faq-item">
        <div class="faq-q" onclick="toggleFaq(this)">Do you offer refunds? <span class="faq-arrow">&#9660;</span></div>
        <div class="faq-a">Yes, we offer a 30-day money-back guarantee on all plans. If you're not satisfied, contact support for a full refund.</div>
      </div>
    </div>
  </div>

  <!-- Interest Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-form" id="modalForm">
        <h2>Get Started with <span id="modalPlanName">Growth</span></h2>
        <div class="modal-plan-tag" id="modalPlanTag">Growth - $99/mo</div>
        <p class="modal-sub">Payment processing is coming soon. Enter your email and we'll notify you the moment it's ready.</p>
        <input type="email" id="modalEmail" placeholder="your@email.com" value="{{ user.email if user else '' }}">
        <button class="modal-submit" id="modalSubmit" onclick="submitInterest()">Notify Me When Ready</button>
        <button class="modal-cancel" onclick="closeModal()">Cancel</button>
      </div>
      <div class="modal-success" id="modalSuccess">
        <div class="check-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <h2>You're on the list!</h2>
        <p class="modal-sub">We'll email you as soon as billing is live. Thanks for your interest in Forge!</p>
        <button class="modal-cancel" onclick="closeModal()" style="margin-top:16px">Close</button>
      </div>
    </div>
  </div>

  <script>
    const prices = {
      monthly: {starter: 49, growth: 99, scale: 199},
      annual: {starter: 39, growth: 79, scale: 159},
    };
    const annualTotals = {starter: '$470', growth: '$950', scale: '$1,910'};
    let billingCycle = 'monthly';
    let selectedPlan = 'growth';

    // Billing toggle
    document.getElementById('billingToggle').addEventListener('click', function() {
      this.classList.toggle('active');
      billingCycle = this.classList.contains('active') ? 'annual' : 'monthly';
      document.getElementById('lblMonthly').classList.toggle('active', billingCycle === 'monthly');
      document.getElementById('lblAnnual').classList.toggle('active', billingCycle === 'annual');
      updatePrices();
    });

    function updatePrices() {
      const cards = document.querySelectorAll('.plan-card');
      cards.forEach(card => {
        const plan = card.dataset.plan;
        const price = prices[billingCycle][plan];
        card.querySelector('.price-val').textContent = '$' + price;
        const annualEl = card.querySelector('.annual-price');
        if (billingCycle === 'annual') {
          annualEl.style.display = 'block';
          annualEl.textContent = 'Billed as ' + annualTotals[plan] + '/year';
        } else {
          annualEl.style.display = 'none';
        }
      });
    }

    function openModal(plan) {
      selectedPlan = plan;
      const price = prices[billingCycle][plan];
      const planNames = {starter: 'Starter', growth: 'Growth', scale: 'Scale'};
      document.getElementById('modalPlanName').textContent = planNames[plan];
      document.getElementById('modalPlanTag').textContent = planNames[plan] + ' - $' + price + '/' + (billingCycle === 'annual' ? 'mo (annual)' : 'mo');
      document.getElementById('modalForm').classList.remove('hidden');
      document.getElementById('modalSuccess').classList.remove('show');
      document.getElementById('modalOverlay').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('show');
    }

    document.getElementById('modalOverlay').addEventListener('click', function(e) {
      if (e.target === this) closeModal();
    });

    async function submitInterest() {
      const email = document.getElementById('modalEmail').value.trim();
      if (!email || !email.includes('@')) {
        document.getElementById('modalEmail').style.borderColor = 'var(--danger)';
        return;
      }
      const btn = document.getElementById('modalSubmit');
      btn.disabled = true;
      btn.textContent = 'Submitting...';

      try {
        await fetch('/api/dashboard/plan-interest', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          credentials: 'same-origin',
          body: JSON.stringify({email, plan: selectedPlan, billing_cycle: billingCycle}),
        });
      } catch (e) {
        console.error(e);
      }

      document.getElementById('modalForm').classList.add('hidden');
      document.getElementById('modalSuccess').classList.add('show');
      btn.disabled = false;
      btn.textContent = 'Notify Me When Ready';
    }

    function toggleFaq(el) {
      el.classList.toggle('open');
      el.nextElementSibling.classList.toggle('open');
    }
  </script>
</body>
</html>
