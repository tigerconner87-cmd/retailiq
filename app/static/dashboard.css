/* =============================================
   RetailIQ Dashboard Styles
   ============================================= */

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
button,select,input,textarea{font-family:inherit;font-size:inherit;color:inherit;line-height:inherit}

:root {
  --bg-0:#09090b;--bg-1:#111114;--bg-2:#1a1a1f;--bg-3:#232329;
  --surface:#18181b;--border:#27272a;--border-light:#3f3f46;
  --text:#fafafa;--text2:#a1a1aa;--text3:#71717a;
  --primary:#6366f1;--primary-light:#818cf8;--primary-dark:#4f46e5;
  --accent:#06b6d4;--success:#10b981;--danger:#ef4444;--warning:#f59e0b;
  --sidebar-w:240px;--topbar-h:60px;--radius:12px;--radius-sm:8px;
}

[data-theme="light"] {
  --bg-0:#ffffff;--bg-1:#f8f9fa;--bg-2:#f1f3f5;--bg-3:#e9ecef;
  --surface:#ffffff;--border:#e5e7eb;--border-light:#d1d5db;
  --text:#111827;--text2:#4b5563;--text3:#9ca3af;
}

html{scroll-behavior:smooth}
body{font-family:'Inter',sans-serif;background:var(--bg-0);color:var(--text);display:flex;min-height:100vh;overflow-x:hidden}
a{color:inherit;text-decoration:none}

/* ── Sidebar ── */
.sidebar{width:var(--sidebar-w);background:var(--bg-1);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:100;transition:transform .3s}
.sidebar-header{padding:20px 16px;border-bottom:1px solid var(--border)}
.logo{display:flex;align-items:center;gap:10px;font-weight:800;font-size:18px}
.sidebar-nav{flex:1;padding:12px 8px;display:flex;flex-direction:column;gap:2px}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:var(--radius-sm);font-size:14px;font-weight:500;color:var(--text2);transition:.2s;position:relative}
.nav-item:hover{background:var(--bg-2);color:var(--text)}
.nav-item.active{background:rgba(99,102,241,.1);color:var(--primary-light)}
.nav-item .badge{position:absolute;right:12px;background:var(--danger);color:#fff;font-size:11px;font-weight:700;padding:1px 6px;border-radius:50px;min-width:20px;text-align:center}
.sidebar-footer{padding:16px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.user-info{display:flex;align-items:center;gap:10px}
.user-avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff}
.user-name{font-size:13px;font-weight:600}
.user-plan{font-size:11px;color:var(--text3);text-transform:capitalize}
.logout-btn{background:none;border:1px solid var(--border);border-radius:var(--radius-sm);width:34px;height:34px;display:flex;align-items:center;justify-content:center;color:var(--text3);cursor:pointer;transition:.2s}
.logout-btn:hover{border-color:var(--danger);color:var(--danger)}

/* ── Main ── */
.main{flex:1;margin-left:var(--sidebar-w);display:flex;flex-direction:column;min-height:100vh}
.topbar{height:var(--topbar-h);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 24px;background:var(--bg-1);position:sticky;top:0;z-index:50}
.topbar-left h1{font-size:18px;font-weight:700}
.topbar-shop{font-size:12px;color:var(--text3);margin-left:12px}
.topbar-right{display:flex;align-items:center;gap:12px}
.refresh-indicator{color:var(--text3);display:flex;align-items:center}
.refresh-indicator.spinning svg{animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.theme-toggle{background:none;border:1px solid var(--border);border-radius:var(--radius-sm);width:34px;height:34px;display:flex;align-items:center;justify-content:center;color:var(--text2);cursor:pointer;transition:.2s}
.theme-toggle:hover{border-color:var(--primary);color:var(--primary-light)}
[data-theme="dark"] .icon-sun{display:block}[data-theme="dark"] .icon-moon{display:none}
[data-theme="light"] .icon-sun{display:none}[data-theme="light"] .icon-moon{display:block}
.mobile-toggle{display:none;background:none;border:none;color:var(--text);cursor:pointer;padding:4px}

/* ── Content ── */
.content{padding:24px;flex:1}
.section{display:none}
.section.active{display:block}

/* ── KPI Cards ── */
.kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
.kpi-grid.small{grid-template-columns:repeat(4,1fr)}
.kpi-card{padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);transition:transform .2s}
.kpi-card:hover{transform:translateY(-2px)}
.kpi-label{font-size:12px;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:8px}
.kpi-value{font-size:28px;font-weight:800;letter-spacing:-.02em}
.kpi-change{font-size:13px;font-weight:600;margin-top:4px}
.kpi-change.up{color:var(--success)}
.kpi-change.down{color:var(--danger)}
.kpi-sub{font-size:12px;color:var(--text3);margin-top:4px}

/* ── Cards ── */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.card-header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.card-header h3{font-size:14px;font-weight:700}
.card-body{padding:20px}

/* ── Chart Row ── */
.chart-row{display:grid;grid-template-columns:1.6fr 1fr;gap:16px;margin-bottom:16px}
.chart-card.wide{min-height:320px}
.chart-card canvas{width:100%!important;max-height:260px}

/* ── Grid ── */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.mt{margin-top:16px}

/* ── Data Table ── */
.data-table{width:100%;border-collapse:collapse}
.data-table th{text-align:left;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.04em;color:var(--text3);padding:8px 12px;border-bottom:1px solid var(--border)}
.data-table td{padding:10px 12px;border-bottom:1px solid var(--border);font-size:13px;color:var(--text2)}
.data-table tr:last-child td{border-bottom:none}
.data-table tr:hover td{background:var(--bg-2)}

/* ── Heatmap ── */
.heatmap-container{display:flex;flex-direction:column;gap:2px;min-height:200px}
.heatmap-row{display:flex;align-items:center;gap:2px}
.heatmap-label{width:32px;font-size:10px;color:var(--text3);text-align:right;padding-right:4px;flex-shrink:0}
.heatmap-cell{flex:1;height:22px;border-radius:3px;min-width:16px;position:relative;cursor:default}
.heatmap-cell:hover::after{content:attr(data-tip);position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:var(--bg-3);color:var(--text);padding:4px 8px;border-radius:4px;font-size:10px;white-space:nowrap;z-index:10;pointer-events:none}
.heatmap-header{display:flex;gap:2px;padding-left:36px;margin-bottom:2px}
.heatmap-header span{flex:1;font-size:9px;color:var(--text3);text-align:center}

/* ── Alerts ── */
.alert-list{display:flex;flex-direction:column;gap:8px}
.alert-item{padding:12px 16px;border-radius:var(--radius-sm);border-left:3px solid var(--border);background:var(--bg-2);transition:.2s}
.alert-item.critical{border-left-color:var(--danger)}
.alert-item.warning{border-left-color:var(--warning)}
.alert-item.info{border-left-color:var(--accent)}
.alert-item .alert-title{font-size:13px;font-weight:600;margin-bottom:4px}
.alert-item .alert-msg{font-size:12px;color:var(--text2)}
.alert-item .alert-time{font-size:11px;color:var(--text3);margin-top:4px}
.alert-item.unread{background:var(--bg-3)}

/* ── Reviews ── */
.review-list{display:flex;flex-direction:column;gap:12px}
.review-item{padding:16px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--bg-2)}
.review-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.review-author{font-size:13px;font-weight:600}
.review-stars{color:var(--warning);font-size:14px;letter-spacing:1px}
.review-text{font-size:13px;color:var(--text2);line-height:1.6;font-style:italic}
.review-date{font-size:11px;color:var(--text3);margin-top:8px}
.sentiment-tag{display:inline-block;padding:2px 8px;border-radius:50px;font-size:10px;font-weight:600;text-transform:uppercase}
.sentiment-tag.positive{background:rgba(16,185,129,.15);color:var(--success)}
.sentiment-tag.negative{background:rgba(239,68,68,.15);color:var(--danger)}
.sentiment-tag.neutral{background:rgba(245,158,11,.15);color:var(--warning)}

/* ── Empty State ── */
.empty-state{text-align:center;padding:40px 20px;color:var(--text3)}
.empty-state p{font-size:14px}

/* ── AI Actions ── */
.ai-actions-card{background:var(--surface);border:1px solid var(--primary);border-radius:var(--radius);margin-bottom:20px;overflow:hidden;box-shadow:0 0 20px rgba(99,102,241,.08)}
.ai-actions-header{padding:16px 20px;border-bottom:1px solid var(--border);background:linear-gradient(135deg,rgba(99,102,241,.06),rgba(6,182,212,.04))}
.ai-actions-title{display:flex;align-items:center;gap:8px;font-size:15px;font-weight:700;color:var(--primary-light)}
.ai-tag{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.06em;padding:2px 8px;border-radius:50px;background:rgba(99,102,241,.12);color:var(--primary-light);margin-left:4px}
.ai-actions-body{padding:12px 16px;display:flex;flex-direction:column;gap:2px}
.ai-action{display:flex;gap:14px;padding:12px 8px;border-radius:var(--radius-sm);transition:background .15s}
.ai-action:hover{background:var(--bg-2)}
.ai-action-emoji{font-size:22px;flex-shrink:0;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:var(--radius-sm);background:var(--bg-2)}
.ai-action-content{flex:1;min-width:0}
.ai-action-title{font-size:13px;font-weight:600;margin-bottom:2px}
.ai-action-desc{font-size:12px;color:var(--text2);line-height:1.5}
.ai-action .priority-dot{display:inline-block;width:6px;height:6px;border-radius:50%;margin-right:6px;flex-shrink:0;margin-top:5px}
.ai-action .priority-dot.high{background:var(--danger)}
.ai-action .priority-dot.medium{background:var(--warning)}
.ai-action .priority-dot.low{background:var(--success)}
.ai-loading{text-align:center;padding:20px;color:var(--text3);font-size:13px}

/* ── Competitor Intelligence ── */
.comp-tabs{display:flex;gap:4px;margin-bottom:20px;overflow-x:auto;padding-bottom:4px}
.comp-tab{padding:8px 16px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:13px;font-weight:600;cursor:pointer;transition:.2s;white-space:nowrap}
.comp-tab:hover{border-color:var(--primary);color:var(--primary-light)}
.comp-tab.active{background:rgba(99,102,241,.15);border-color:var(--primary);color:var(--primary-light);box-shadow:0 0 8px rgba(99,102,241,.15)}
.comp-panel{display:none}
.comp-panel.active{display:block}

/* Competitor Cards Grid */
.comp-cards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
.comp-card{padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);transition:transform .2s}
.comp-card:hover{transform:translateY(-2px)}
.comp-card.own-shop{border-color:var(--primary);box-shadow:0 0 20px rgba(99,102,241,.1)}
.comp-card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
.comp-card-name{font-size:15px;font-weight:700}
.comp-card-name .own-tag{font-size:10px;font-weight:600;padding:2px 8px;border-radius:50px;background:rgba(99,102,241,.15);color:var(--primary-light);margin-left:8px;vertical-align:middle}
.threat-badge{padding:3px 10px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.04em}
.threat-badge.high{background:rgba(239,68,68,.15);color:var(--danger)}
.threat-badge.medium{background:rgba(245,158,11,.15);color:var(--warning)}
.threat-badge.low{background:rgba(16,185,129,.15);color:var(--success)}
.comp-card-rating{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.comp-card-rating .stars{color:var(--warning);font-size:16px;letter-spacing:1px}
.comp-card-rating .rating-num{font-size:22px;font-weight:800}
.comp-card-stats{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.comp-stat{padding:8px;background:var(--bg-2);border-radius:var(--radius-sm)}
.comp-stat-label{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.04em}
.comp-stat-value{font-size:14px;font-weight:700;margin-top:2px}
.trend-arrow{font-size:12px;margin-left:4px}
.trend-arrow.up{color:var(--success)}
.trend-arrow.down{color:var(--danger)}

/* Comparison Table */
.comp-table-wrap{overflow-x:auto}
.comp-comparison-table td{font-size:12px}
.comp-comparison-table .winning{color:var(--success);font-weight:600}
.comp-comparison-table .losing{color:var(--danger);font-weight:600}
.comp-comparison-table .own-row td{background:rgba(99,102,241,.05)}
.comp-comparison-table .tags{display:flex;flex-wrap:wrap;gap:4px}
.comp-comparison-table .tag{padding:2px 6px;border-radius:4px;font-size:10px;font-weight:600}
.comp-comparison-table .tag.strength{background:rgba(16,185,129,.12);color:var(--success)}
.comp-comparison-table .tag.weakness{background:rgba(239,68,68,.12);color:var(--danger)}

/* Opportunity Alerts */
.opp-list{display:flex;flex-direction:column;gap:16px}
.opp-card{padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);border-left:4px solid var(--border);transition:.2s}
.opp-card:hover{transform:translateY(-2px)}
.opp-card.hot{border-left-color:var(--danger)}
.opp-card.good{border-left-color:var(--warning)}
.opp-card.fyi{border-left-color:var(--accent)}
.opp-card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.opp-card-title{font-size:14px;font-weight:700}
.opp-priority{padding:3px 10px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.04em;flex-shrink:0}
.opp-priority.hot{background:rgba(239,68,68,.15);color:var(--danger)}
.opp-priority.good{background:rgba(245,158,11,.15);color:var(--warning)}
.opp-priority.fyi{background:rgba(6,182,212,.15);color:var(--accent)}
.opp-desc{font-size:13px;color:var(--text2);margin-bottom:8px;line-height:1.5}
.opp-why{font-size:12px;color:var(--text3);padding:8px 12px;background:var(--bg-2);border-radius:var(--radius-sm);margin-bottom:12px;line-height:1.5}
.opp-actions{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}
.opp-action{padding:12px;background:var(--bg-2);border-radius:var(--radius-sm);border:1px solid var(--border)}
.opp-action-label{font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:6px}
.opp-action-text{font-size:12px;color:var(--text2);line-height:1.5}
.opp-action .copy-btn{margin-top:8px;padding:4px 12px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:11px;font-weight:600;cursor:pointer;transition:.2s}
.opp-action .copy-btn:hover{border-color:var(--primary);color:var(--primary-light)}

/* Competitor Filters */
.comp-filters{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap}
.comp-filters select{padding:8px 12px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text);font-size:13px;cursor:pointer}

/* Competitor Review Feed Items */
.comp-review-item{padding:16px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--bg-2)}
.comp-review-item .review-comp-name{font-size:11px;color:var(--primary-light);font-weight:600;text-transform:uppercase;letter-spacing:.04em;margin-bottom:4px}
.comp-review-item .capitalize-btn{margin-top:10px;padding:6px 14px;border:1px solid var(--danger);border-radius:var(--radius-sm);background:rgba(239,68,68,.08);color:var(--danger);font-size:12px;font-weight:600;cursor:pointer;transition:.2s}
.comp-review-item .capitalize-btn:hover{background:rgba(239,68,68,.15)}

/* Sentiment Analysis Grid */
.sentiment-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:16px}
.sentiment-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.sentiment-card-header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.sentiment-card-header h4{font-size:14px;font-weight:700}
.sentiment-card-body{padding:16px 20px}
.sentiment-bar{display:flex;height:8px;border-radius:4px;overflow:hidden;margin-bottom:12px}
.sentiment-bar .bar-pos{background:var(--success)}
.sentiment-bar .bar-neu{background:var(--warning)}
.sentiment-bar .bar-neg{background:var(--danger)}
.sentiment-labels{display:flex;justify-content:space-between;font-size:11px;color:var(--text3);margin-bottom:12px}
.term-cloud{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:8px}
.term-cloud .term{padding:3px 8px;border-radius:4px;font-size:11px;font-weight:600}
.term-cloud .term.positive{background:rgba(16,185,129,.12);color:var(--success)}
.term-cloud .term.negative{background:rgba(239,68,68,.12);color:var(--danger)}
.sentiment-trend-label{font-size:11px;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-top:12px;margin-bottom:6px}

/* Market Map */
.market-map-container{position:relative;min-height:400px}
.market-map-container canvas{width:100%!important;max-height:400px}
.card-sub{font-size:11px;color:var(--text3)}

/* Weekly Report — Newsletter Style */
.weekly-report{max-width:800px;margin:0 auto}
.wr-header{padding:32px;background:linear-gradient(135deg,rgba(99,102,241,.1),rgba(6,182,212,.06));border:1px solid rgba(99,102,241,.3);border-radius:var(--radius);margin-bottom:24px;text-align:center}
.wr-header h2{font-size:22px;font-weight:900;margin-bottom:6px;background:linear-gradient(135deg,var(--primary-light),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.wr-header .wr-dates{font-size:13px;color:var(--text3)}
.wr-summary{font-size:14px;line-height:1.8;color:var(--text2);padding:20px 24px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:20px;position:relative}
.wr-summary::before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:var(--radius) var(--radius) 0 0}
.wr-section{margin-bottom:20px;padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)}
.wr-section h3{font-size:15px;font-weight:700;margin-bottom:16px;padding-bottom:10px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px}
.wr-section h3::before{content:"";width:4px;height:18px;background:var(--primary);border-radius:2px}
.wr-comp-row{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--bg-2);border-radius:var(--radius-sm);margin-bottom:8px;border:1px solid var(--border);transition:.2s}
.wr-comp-row:hover{border-color:var(--primary);transform:translateX(4px)}
.wr-comp-name{font-size:13px;font-weight:700}
.wr-comp-stats{display:flex;gap:16px;font-size:12px;color:var(--text2)}
.wr-opp-item{padding:12px 16px;border-left:3px solid var(--warning);background:var(--bg-2);border-radius:0 var(--radius-sm) var(--radius-sm) 0;margin-bottom:8px;font-size:13px;color:var(--text2);line-height:1.6}
.wr-action-item{padding:10px 16px;font-size:13px;color:var(--text2);line-height:1.5;display:flex;align-items:flex-start;gap:10px}
.wr-action-item::before{content:"";width:8px;height:8px;border-radius:50%;background:var(--primary);flex-shrink:0;margin-top:5px}

/* Marketing Responses */
.marketing-filters{display:flex;gap:6px;margin-bottom:16px}
.mkt-filter-btn{padding:6px 14px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:.2s}
.mkt-filter-btn:hover{border-color:var(--primary);color:var(--primary-light)}
.mkt-filter-btn.active{background:rgba(99,102,241,.15);border-color:var(--primary);color:var(--primary-light)}
.marketing-list{display:flex;flex-direction:column;gap:16px}
.mkt-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.mkt-card-header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.mkt-card-header h4{font-size:14px;font-weight:700}
.mkt-card-meta{display:flex;gap:8px;align-items:center}
.mkt-status{padding:2px 8px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase}
.mkt-status.new{background:rgba(6,182,212,.15);color:var(--accent)}
.mkt-status.saved{background:rgba(99,102,241,.15);color:var(--primary-light)}
.mkt-status.used{background:rgba(16,185,129,.15);color:var(--success)}
.mkt-card-body{padding:16px 20px}
.mkt-weakness{font-size:13px;color:var(--text2);margin-bottom:12px;padding:10px;background:var(--bg-2);border-radius:var(--radius-sm);border-left:3px solid var(--warning)}
.mkt-responses{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
.mkt-response{padding:12px;background:var(--bg-2);border-radius:var(--radius-sm);border:1px solid var(--border)}
.mkt-response-label{font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:6px}
.mkt-response-text{font-size:12px;color:var(--text2);line-height:1.5;white-space:pre-wrap}
.mkt-card-actions{padding:12px 20px;border-top:1px solid var(--border);display:flex;gap:8px;justify-content:flex-end}
.mkt-btn{padding:6px 14px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:.2s}
.mkt-btn:hover{border-color:var(--primary);color:var(--primary-light)}
.mkt-btn.save{border-color:var(--primary);color:var(--primary-light)}
.mkt-btn.used{border-color:var(--success);color:var(--success)}

/* Capitalize modal — glassmorphism */
.cap-modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);z-index:200;align-items:center;justify-content:center}
.cap-modal-overlay.show{display:flex;animation:capFadeIn .3s ease}
@keyframes capFadeIn{from{opacity:0}to{opacity:1}}
.cap-modal{background:rgba(24,24,27,.92);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(99,102,241,.2);border-radius:var(--radius);width:90%;max-width:720px;max-height:80vh;overflow-y:auto;padding:28px;box-shadow:0 25px 60px rgba(0,0,0,.5),0 0 40px rgba(99,102,241,.08);animation:capSlideIn .3s ease}
@keyframes capSlideIn{from{opacity:0;transform:translateY(20px) scale(.97)}to{opacity:1;transform:translateY(0) scale(1)}}
[data-theme="light"] .cap-modal{background:rgba(255,255,255,.92);box-shadow:0 25px 60px rgba(0,0,0,.15),0 0 40px rgba(99,102,241,.05)}
.cap-modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid var(--border)}
.cap-modal-header h3{font-size:16px;font-weight:800;background:linear-gradient(135deg,var(--primary-light),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.cap-close{background:none;border:1px solid var(--border);border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;color:var(--text3);font-size:18px;cursor:pointer;transition:.2s}
.cap-close:hover{border-color:var(--danger);color:var(--danger)}
.cap-meta{display:flex;gap:12px;align-items:center;margin-bottom:20px;padding:12px 16px;background:var(--bg-2);border-radius:var(--radius-sm);border-left:3px solid var(--primary)}
.cap-comp-name{font-size:13px;font-weight:700;color:var(--primary-light)}
.cap-weakness{font-size:12px;color:var(--text2);flex:1}
.cap-responses{display:flex;flex-direction:column;gap:12px;margin-bottom:20px}
.cap-response-item{padding:16px;background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-sm);transition:.2s}
.cap-response-item:hover{border-color:var(--primary);box-shadow:0 0 12px rgba(99,102,241,.06)}
.cap-response-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.cap-response-label{font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em}
.cap-copy-btn{padding:4px 12px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:11px;font-weight:600;cursor:pointer;transition:.2s}
.cap-copy-btn:hover{border-color:var(--primary);color:var(--primary-light)}
.cap-response-text{font-size:13px;color:var(--text2);line-height:1.6;white-space:pre-wrap}
.cap-actions{display:flex;gap:8px;justify-content:flex-end;padding-top:16px;border-top:1px solid var(--border)}
.cap-btn{padding:8px 20px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);font-size:13px;font-weight:600;cursor:pointer;transition:.2s}
.cap-btn.save{border-color:var(--primary);color:var(--primary-light)}
.cap-btn.save:hover{background:rgba(99,102,241,.1)}
.cap-btn.used{border-color:var(--success);color:var(--success)}
.cap-btn.used:hover{background:rgba(16,185,129,.1)}

/* Expandable opportunity actions */
.opp-expand-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:.2s;margin-top:4px}
.opp-expand-btn:hover{border-color:var(--primary);color:var(--primary-light)}
.opp-expand-btn .expand-arrow{transition:transform .3s ease;font-size:10px}
.opp-expand-btn.expanded .expand-arrow{transform:rotate(180deg)}
.opp-actions-wrap{overflow:hidden;max-height:0;transition:max-height .4s ease,margin .3s ease;margin-top:0}
.opp-actions-wrap.expanded{max-height:500px;margin-top:12px}

/* Marketing response copy buttons */
.mkt-response-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.mkt-copy-btn{padding:3px 10px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text3);font-size:10px;font-weight:600;cursor:pointer;transition:.2s}
.mkt-copy-btn:hover{border-color:var(--primary);color:var(--primary-light)}

/* ── Goals & Strategy ── */
.goals-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px;margin-bottom:24px}
.goal-card{padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);transition:transform .2s}
.goal-card:hover{transform:translateY(-2px)}
.goal-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.goal-card-title{font-size:14px;font-weight:700}
.goal-pacing{padding:3px 10px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.03em}
.goal-pacing.on_track{background:rgba(16,185,129,.15);color:var(--success)}
.goal-pacing.behind{background:rgba(245,158,11,.15);color:var(--warning)}
.goal-pacing.at_risk{background:rgba(239,68,68,.15);color:var(--danger)}
.goal-value{font-size:24px;font-weight:800;margin-bottom:4px}
.goal-value .goal-target{font-size:14px;font-weight:500;color:var(--text3)}
.goal-progress{margin:12px 0}
.goal-progress-bar{height:8px;background:var(--bg-3);border-radius:4px;overflow:hidden}
.goal-progress-fill{height:100%;border-radius:4px;transition:width .6s ease}
.goal-progress-fill.on_track{background:linear-gradient(90deg,var(--success),#34d399)}
.goal-progress-fill.behind{background:linear-gradient(90deg,var(--warning),#fbbf24)}
.goal-progress-fill.at_risk{background:linear-gradient(90deg,var(--danger),#f87171)}
.goal-stats{display:flex;justify-content:space-between;gap:8px}
.goal-stat{font-size:12px;color:var(--text3)}
.goal-stat strong{color:var(--text);font-weight:700}
.strategy-card{padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:12px;transition:.2s}
.strategy-card:hover{border-color:var(--primary)}
.strategy-quarter{font-size:12px;font-weight:700;color:var(--primary-light);text-transform:uppercase;letter-spacing:.04em;margin-bottom:4px}
.strategy-title{font-size:16px;font-weight:700;margin-bottom:12px}
.strategy-section{margin-bottom:12px}
.strategy-section-label{font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:6px}
.strategy-list{list-style:none;padding:0}
.strategy-list li{padding:6px 0;font-size:13px;color:var(--text2);display:flex;align-items:flex-start;gap:8px}
.strategy-list li::before{content:"";width:6px;height:6px;border-radius:50%;background:var(--primary);flex-shrink:0;margin-top:6px}
.strategy-status{display:inline-block;padding:2px 8px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase;margin-left:8px}
.strategy-status.active{background:rgba(99,102,241,.15);color:var(--primary-light)}
.strategy-status.completed{background:rgba(16,185,129,.15);color:var(--success)}
.goal-status{display:inline-block;padding:2px 8px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase}
.goal-status.met{background:rgba(16,185,129,.15);color:var(--success)}
.goal-status.missed{background:rgba(239,68,68,.15);color:var(--danger)}
.goal-status.active{background:rgba(99,102,241,.15);color:var(--primary-light)}
.progress-mini{display:flex;align-items:center;gap:8px}
.progress-mini-bar{flex:1;height:6px;background:var(--bg-3);border-radius:3px;overflow:hidden;min-width:60px}
.progress-mini-fill{height:100%;border-radius:3px;background:var(--primary)}
.progress-mini-pct{font-size:11px;font-weight:700;color:var(--text2);min-width:38px;text-align:right}
.progress-mini-pct.overperforming{color:var(--success)}
.progress-mini-pct.underperforming{color:var(--danger)}
.progress-mini-fill.overperforming{background:var(--success)}
.progress-mini-fill.underperforming{background:var(--danger)}
.progress-over-label{font-size:10px;font-weight:600;color:var(--success);white-space:nowrap;margin-left:4px}

/* ── Marketing Content Engine ── */
.mke-tabs{display:flex;gap:4px;margin-bottom:20px;overflow-x:auto;padding-bottom:4px}
.mke-tab{padding:8px 16px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:13px;font-weight:600;cursor:pointer;transition:.2s;white-space:nowrap}
.mke-tab:hover{border-color:var(--primary);color:var(--primary-light)}
.mke-tab.active{background:rgba(99,102,241,.15);border-color:var(--primary);color:var(--primary-light);box-shadow:0 0 8px rgba(99,102,241,.15)}
.mke-panel{display:none}
.mke-panel.active{display:block}
.mke-panel-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;gap:16px;flex-wrap:wrap}
.mke-panel-title{font-size:18px;font-weight:800;margin-bottom:4px}
.mke-panel-sub{font-size:13px;color:var(--text3);max-width:600px}
.mke-panel-actions{display:flex;gap:8px;flex-shrink:0}
.mke-btn{padding:8px 18px;border-radius:var(--radius-sm);font-size:13px;font-weight:600;cursor:pointer;transition:.2s;border:1px solid var(--border)}
.mke-btn.primary{background:var(--primary);border-color:var(--primary);color:#fff}
.mke-btn.primary:hover{background:var(--primary-dark)}
.mke-btn.primary:disabled{opacity:.5;cursor:not-allowed}
.mke-btn.outline{background:var(--surface);color:var(--text2)}
.mke-btn.outline:hover{border-color:var(--primary);color:var(--primary-light)}

/* Calendar */
.mke-calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
.mke-cal-day{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;min-height:180px}
.mke-cal-day.today{border-color:var(--primary);box-shadow:0 0 12px rgba(99,102,241,.1)}
.mke-cal-day-header{padding:10px 12px;background:var(--bg-2);border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.mke-cal-day-name{font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:.04em}
.mke-cal-day.today .mke-cal-day-name{color:var(--primary-light)}
.mke-cal-day-date{font-size:11px;color:var(--text3)}
.mke-cal-posts{padding:8px;display:flex;flex-direction:column;gap:8px}
.mke-cal-post{padding:10px;background:var(--bg-2);border-radius:var(--radius-sm);border:1px solid transparent;transition:.2s}
.mke-cal-post:hover{border-color:var(--primary)}
.mke-cal-post-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.mke-platform-badge{display:inline-flex;align-items:center;gap:4px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.03em}
.mke-cal-time{font-size:10px;color:var(--text3);font-weight:600}
.mke-cal-post-content{font-size:11px;color:var(--text2);line-height:1.5;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;overflow:hidden}
.mke-copy-btn{padding:4px 12px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:11px;font-weight:600;cursor:pointer;transition:.2s;margin-top:6px}
.mke-copy-btn:hover{border-color:var(--primary);color:var(--primary-light)}
.mke-copy-btn.secondary{border-color:var(--border-light);color:var(--text3)}
.mke-copy-btn.secondary:hover{border-color:var(--accent);color:var(--accent)}

/* Social Posts */
.mke-social-filters{display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap}
.mke-filter-btn{padding:6px 14px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--surface);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:.2s}
.mke-filter-btn:hover{border-color:var(--primary);color:var(--primary-light)}
.mke-filter-btn.active{background:rgba(99,102,241,.15);border-color:var(--primary);color:var(--primary-light)}
.mke-social-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:16px}
.mke-social-card{padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);transition:.2s}
.mke-social-card:hover{border-color:var(--primary);transform:translateY(-2px)}
.mke-social-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.mke-category-badge{padding:3px 10px;border-radius:50px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.03em;background:rgba(99,102,241,.1);color:var(--primary-light)}
.mke-social-caption{font-size:13px;color:var(--text);line-height:1.6;margin-bottom:12px;white-space:pre-wrap}
.mke-social-meta{display:flex;gap:16px;margin-bottom:8px}
.mke-meta-item{font-size:11px;color:var(--text3)}
.mke-meta-item strong{color:var(--text2)}
.mke-social-hashtags{font-size:11px;color:var(--accent);margin-bottom:12px;line-height:1.6}
.mke-social-actions{display:flex;gap:8px}

/* Email Campaigns */
.mke-email-list{display:flex;flex-direction:column;gap:20px}
.mke-email-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;transition:.2s}
.mke-email-card:hover{border-color:var(--primary)}
.mke-email-header{padding:20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:flex-start;gap:16px;flex-wrap:wrap}
.mke-email-name{font-size:16px;font-weight:700;margin-bottom:4px}
.mke-email-target{font-size:12px;color:var(--text3)}
.mke-email-stats{display:flex;gap:16px;flex-shrink:0}
.mke-email-stat{font-size:12px;color:var(--text3);display:flex;flex-direction:column;text-align:center}
.mke-email-stat strong{font-size:14px;color:var(--text);font-weight:700}
.mke-email-preview{padding:20px}
.mke-email-subject-row{margin-bottom:8px;display:flex;gap:8px;align-items:flex-start}
.mke-email-label{font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;flex-shrink:0;margin-top:2px}
.mke-email-subject{font-size:14px;font-weight:600;color:var(--text)}
.mke-email-preview-text{font-size:12px;color:var(--text3);margin-bottom:16px;display:flex;gap:8px}
.mke-email-body-wrap{background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:20px;max-height:300px;overflow-y:auto}
.mke-email-body{font-size:13px;color:var(--text2);line-height:1.7;white-space:pre-wrap}
.mke-email-actions{padding:16px 20px;border-top:1px solid var(--border);display:flex;gap:8px;justify-content:flex-end}

/* Promotions */
.mke-promo-list{display:flex;flex-direction:column;gap:20px}
.mke-promo-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:24px;transition:.2s}
.mke-promo-card:hover{border-color:var(--primary)}
.mke-promo-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.mke-promo-name{font-size:16px;font-weight:700}
.mke-promo-desc{font-size:13px;color:var(--text2);line-height:1.6;margin-bottom:16px;padding:12px 16px;background:var(--bg-2);border-radius:var(--radius-sm);border-left:3px solid var(--primary)}
.mke-promo-details{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px}
.mke-promo-detail{padding:12px;background:var(--bg-2);border-radius:var(--radius-sm);font-size:13px;color:var(--text2)}
.mke-promo-detail-label{display:block;font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:4px}
.mke-promo-steps{margin-bottom:16px}
.mke-promo-steps-label{font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:8px}
.mke-promo-steps-list{padding-left:20px;display:flex;flex-direction:column;gap:4px}
.mke-promo-steps-list li{font-size:12px;color:var(--text2);line-height:1.6}
.mke-promo-social{padding:16px;background:var(--bg-2);border:1px solid var(--border);border-radius:var(--radius-sm)}
.mke-promo-social-label{font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:8px}
.mke-promo-social-text{font-size:13px;color:var(--text2);line-height:1.6;margin-bottom:8px}

/* Performance */
.mke-perf-breakdown{display:flex;flex-direction:column;gap:2px}
.mke-perf-row{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;font-size:13px;color:var(--text2);border-radius:var(--radius-sm);transition:.15s}
.mke-perf-row:hover{background:var(--bg-2)}
.mke-perf-row.total{border-top:1px solid var(--border);margin-top:4px;padding-top:14px;font-weight:600;color:var(--text)}
.mke-stat-new{color:var(--accent)}
.mke-stat-saved{color:var(--primary-light)}
.mke-stat-used{color:var(--success)}
.mke-impact-card{padding:24px;background:linear-gradient(135deg,rgba(99,102,241,.06),rgba(6,182,212,.04));border:1px solid rgba(99,102,241,.2);border-radius:var(--radius-sm)}
.mke-impact-text{font-size:14px;color:var(--text2);line-height:1.7;margin-bottom:12px}
.mke-impact-text strong{color:var(--success);font-weight:700}
.mke-impact-tip{font-size:12px;color:var(--text3);padding:10px 14px;background:var(--bg-2);border-radius:var(--radius-sm);line-height:1.5}
.mke-cta-card{display:flex;align-items:center;gap:20px;padding:20px;background:linear-gradient(135deg,rgba(225,48,108,.06),rgba(99,102,241,.06));border:1px solid rgba(225,48,108,.2);border-radius:var(--radius-sm)}
.mke-cta-icon{color:var(--danger);flex-shrink:0}
.mke-cta-content{flex:1}
.mke-cta-title{font-size:15px;font-weight:700;margin-bottom:4px}
.mke-cta-desc{font-size:12px;color:var(--text3);line-height:1.5}

/* ── Responsive ── */
@media(max-width:1024px){
  .kpi-grid{grid-template-columns:repeat(2,1fr)}
  .chart-row{grid-template-columns:1fr}
  .grid-2{grid-template-columns:1fr}
  .opp-actions{grid-template-columns:1fr}
  .mkt-responses{grid-template-columns:1fr}
  .sentiment-grid{grid-template-columns:1fr}
  .mke-calendar-grid{grid-template-columns:repeat(4,1fr)}
  .mke-promo-details{grid-template-columns:1fr}
  .mke-social-grid{grid-template-columns:1fr}
  .mke-cta-card{flex-direction:column;text-align:center}
}
@media(max-width:768px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .main{margin-left:0}
  .mobile-toggle{display:flex}
  .kpi-grid.small{grid-template-columns:repeat(2,1fr)}
  .mke-calendar-grid{grid-template-columns:1fr 1fr}
  .mke-panel-header{flex-direction:column}
}
